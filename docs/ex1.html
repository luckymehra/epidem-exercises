<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 1 Exercise 1 | Epidemiological exercises in R</title>
  <meta name="description" content="This book contains epidemiological data analysis exercises in R. These are written for students of PLPTH 905 (Ecology and Epidemiology of Plant Pathogens) offered in even springs at Kansas State University." />
  <meta name="generator" content="bookdown 0.12 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 1 Exercise 1 | Epidemiological exercises in R" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="This book contains epidemiological data analysis exercises in R. These are written for students of PLPTH 905 (Ecology and Epidemiology of Plant Pathogens) offered in even springs at Kansas State University." />
  <meta name="github-repo" content="luckymehra/epidem-exercises" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 1 Exercise 1 | Epidemiological exercises in R" />
  
  <meta name="twitter:description" content="This book contains epidemiological data analysis exercises in R. These are written for students of PLPTH 905 (Ecology and Epidemiology of Plant Pathogens) offered in even springs at Kansas State University." />
  

<meta name="author" content="Lucky Mehra" />


<meta name="date" content="2019-08-26" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="index.html">
<link rel="next" href="ex4.html">
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />









<style type="text/css">
a.sourceLine { display: inline-block; line-height: 1.25; }
a.sourceLine { pointer-events: none; color: inherit; text-decoration: inherit; }
a.sourceLine:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
a.sourceLine { text-indent: -1em; padding-left: 1em; }
}
pre.numberSource a.sourceLine
  { position: relative; left: -4em; }
pre.numberSource a.sourceLine::before
  { content: attr(title);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; pointer-events: all; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  }
@media screen {
a.sourceLine::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Epidemiological exercises in R</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Prerequisites</a></li>
<li class="chapter" data-level="1" data-path="ex1.html"><a href="ex1.html"><i class="fa fa-check"></i><b>1</b> Exercise 1</a><ul>
<li class="chapter" data-level="1.1" data-path="ex1.html"><a href="ex1.html#load-packages"><i class="fa fa-check"></i><b>1.1</b> Load packages</a></li>
<li class="chapter" data-level="1.2" data-path="ex1.html"><a href="ex1.html#data"><i class="fa fa-check"></i><b>1.2</b> Data</a></li>
<li class="chapter" data-level="1.3" data-path="ex1.html"><a href="ex1.html#descriptive-statistics"><i class="fa fa-check"></i><b>1.3</b> Descriptive statistics</a></li>
<li class="chapter" data-level="1.4" data-path="ex1.html"><a href="ex1.html#create-histogram-boxplot-and-qqplot"><i class="fa fa-check"></i><b>1.4</b> Create histogram, boxplot, and qqplot</a></li>
<li class="chapter" data-level="1.5" data-path="ex1.html"><a href="ex1.html#normality-test"><i class="fa fa-check"></i><b>1.5</b> Normality test</a></li>
<li class="chapter" data-level="1.6" data-path="ex1.html"><a href="ex1.html#linear-regression"><i class="fa fa-check"></i><b>1.6</b> Linear regression</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="ex4.html"><a href="ex4.html"><i class="fa fa-check"></i><b>2</b> Exercise 4</a><ul>
<li class="chapter" data-level="2.1" data-path="ex4.html"><a href="ex4.html#load-packages-1"><i class="fa fa-check"></i><b>2.1</b> Load packages</a></li>
<li class="chapter" data-level="2.2" data-path="ex4.html"><a href="ex4.html#import-data"><i class="fa fa-check"></i><b>2.2</b> Import data</a></li>
<li class="chapter" data-level="2.3" data-path="ex4.html"><a href="ex4.html#first-mixed-model"><i class="fa fa-check"></i><b>2.3</b> First mixed model</a><ul>
<li class="chapter" data-level="2.3.1" data-path="ex4.html"><a href="ex4.html#fit-the-model"><i class="fa fa-check"></i><b>2.3.1</b> Fit the model</a></li>
<li class="chapter" data-level="2.3.2" data-path="ex4.html"><a href="ex4.html#diagnostic-plots"><i class="fa fa-check"></i><b>2.3.2</b> Diagnostic plots</a></li>
</ul></li>
<li class="chapter" data-level="2.4" data-path="ex4.html"><a href="ex4.html#second-mixed-model"><i class="fa fa-check"></i><b>2.4</b> Second mixed model</a><ul>
<li class="chapter" data-level="2.4.1" data-path="ex4.html"><a href="ex4.html#fit-the-model-1"><i class="fa fa-check"></i><b>2.4.1</b> Fit the model</a></li>
<li class="chapter" data-level="2.4.2" data-path="ex4.html"><a href="ex4.html#plot-observed-versus-predicted-model-values"><i class="fa fa-check"></i><b>2.4.2</b> Plot observed versus predicted model values</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="3" data-path="ex9-4.html"><a href="ex9-4.html"><i class="fa fa-check"></i><b>3</b> Exercise 9.4</a><ul>
<li class="chapter" data-level="3.1" data-path="ex9-4.html"><a href="ex9-4.html#load-packages-2"><i class="fa fa-check"></i><b>3.1</b> Load packages</a></li>
<li class="chapter" data-level="3.2" data-path="ex9-4.html"><a href="ex9-4.html#data-1"><i class="fa fa-check"></i><b>3.2</b> Data</a></li>
<li class="chapter" data-level="3.3" data-path="ex9-4.html"><a href="ex9-4.html#autocorrelation-statistics"><i class="fa fa-check"></i><b>3.3</b> Autocorrelation statistics</a></li>
<li class="chapter" data-level="3.4" data-path="ex9-4.html"><a href="ex9-4.html#first-variogram"><i class="fa fa-check"></i><b>3.4</b> First variogram</a></li>
<li class="chapter" data-level="3.5" data-path="ex9-4.html"><a href="ex9-4.html#second-variogram"><i class="fa fa-check"></i><b>3.5</b> Second variogram</a></li>
<li class="chapter" data-level="3.6" data-path="ex9-4.html"><a href="ex9-4.html#variogram-model-selection"><i class="fa fa-check"></i><b>3.6</b> Variogram model selection</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="ex9-5.html"><a href="ex9-5.html"><i class="fa fa-check"></i><b>4</b> Exercise 9.5</a><ul>
<li class="chapter" data-level="4.1" data-path="ex9-5.html"><a href="ex9-5.html#load-packages-3"><i class="fa fa-check"></i><b>4.1</b> Load packages</a></li>
<li class="chapter" data-level="4.2" data-path="ex9-5.html"><a href="ex9-5.html#data-2"><i class="fa fa-check"></i><b>4.2</b> Data</a></li>
<li class="chapter" data-level="4.3" data-path="ex9-5.html"><a href="ex9-5.html#autocorrelation-statistics-1"><i class="fa fa-check"></i><b>4.3</b> Autocorrelation statistics</a></li>
<li class="chapter" data-level="4.4" data-path="ex9-5.html"><a href="ex9-5.html#first-variogram-1"><i class="fa fa-check"></i><b>4.4</b> First variogram</a></li>
<li class="chapter" data-level="4.5" data-path="ex9-5.html"><a href="ex9-5.html#second-variogram-1"><i class="fa fa-check"></i><b>4.5</b> Second variogram</a></li>
<li class="chapter" data-level="4.6" data-path="ex9-5.html"><a href="ex9-5.html#variogram-model-selection-1"><i class="fa fa-check"></i><b>4.6</b> Variogram model selection</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="yieldloss.html"><a href="yieldloss.html"><i class="fa fa-check"></i><b>5</b> Yield loss</a><ul>
<li class="chapter" data-level="5.1" data-path="yieldloss.html"><a href="yieldloss.html#load-packages-4"><i class="fa fa-check"></i><b>5.1</b> Load packages</a></li>
<li class="chapter" data-level="5.2" data-path="yieldloss.html"><a href="yieldloss.html#data-3"><i class="fa fa-check"></i><b>5.2</b> Data</a></li>
<li class="chapter" data-level="5.3" data-path="yieldloss.html"><a href="yieldloss.html#mixed-model-for-response-variable-ds"><i class="fa fa-check"></i><b>5.3</b> Mixed model for response variable DS</a><ul>
<li class="chapter" data-level="5.3.1" data-path="yieldloss.html"><a href="yieldloss.html#diagnostic-plots-1"><i class="fa fa-check"></i><b>5.3.1</b> Diagnostic plots</a></li>
</ul></li>
<li class="chapter" data-level="5.4" data-path="yieldloss.html"><a href="yieldloss.html#mixed-model-for-response-variable-yield"><i class="fa fa-check"></i><b>5.4</b> Mixed model for response variable YIELD</a><ul>
<li class="chapter" data-level="5.4.1" data-path="yieldloss.html"><a href="yieldloss.html#diagnostic-plots-2"><i class="fa fa-check"></i><b>5.4.1</b> Diagnostic plots</a></li>
</ul></li>
<li class="chapter" data-level="5.5" data-path="yieldloss.html"><a href="yieldloss.html#linear-regression-between-yield-and-ds"><i class="fa fa-check"></i><b>5.5</b> Linear regression between YIELD and DS</a><ul>
<li class="chapter" data-level="5.5.1" data-path="yieldloss.html"><a href="yieldloss.html#linear-regression-between-ry1-and-ds"><i class="fa fa-check"></i><b>5.5.1</b> Linear regression between RY1 and DS</a></li>
<li class="chapter" data-level="5.5.2" data-path="yieldloss.html"><a href="yieldloss.html#transform-dataset-a"><i class="fa fa-check"></i><b>5.5.2</b> Transform dataset a</a></li>
</ul></li>
<li class="chapter" data-level="5.6" data-path="yieldloss.html"><a href="yieldloss.html#mixed-model-for-ry2"><i class="fa fa-check"></i><b>5.6</b> Mixed model for RY2</a></li>
<li class="chapter" data-level="5.7" data-path="yieldloss.html"><a href="yieldloss.html#linear-regression-between-ry2-and-cds"><i class="fa fa-check"></i><b>5.7</b> Linear regression between RY2 and CDS</a></li>
</ul></li>
<li class="appendix"><span><b>Appendix</b></span></li>
<li class="chapter" data-level="A" data-path="sascode.html"><a href="sascode.html"><i class="fa fa-check"></i><b>A</b> SAS code</a><ul>
<li class="chapter" data-level="A.1" data-path="sascode.html"><a href="sascode.html#exercise-4"><i class="fa fa-check"></i><b>A.1</b> Exercise 4</a></li>
<li class="chapter" data-level="A.2" data-path="sascode.html"><a href="sascode.html#exercise-9.4"><i class="fa fa-check"></i><b>A.2</b> Exercise 9.4</a></li>
<li class="chapter" data-level="A.3" data-path="sascode.html"><a href="sascode.html#exercise-9.5"><i class="fa fa-check"></i><b>A.3</b> Exercise 9.5</a></li>
<li class="chapter" data-level="A.4" data-path="sascode.html"><a href="sascode.html#yield-loss"><i class="fa fa-check"></i><b>A.4</b> Yield loss</a></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Epidemiological exercises in R</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="ex1" class="section level1">
<h1><span class="header-section-number">Chapter 1</span> Exercise 1</h1>
<div id="load-packages" class="section level2">
<h2><span class="header-section-number">1.1</span> Load packages</h2>
<p>Here is the R code to download the required packages for this exercise.</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1-1" title="1"><span class="co"># install package manager &#39;pacman&#39;</span></a>
<a class="sourceLine" id="cb1-2" title="2"><span class="cf">if</span> (<span class="op">!</span><span class="kw">require</span>(pacman)){</a>
<a class="sourceLine" id="cb1-3" title="3">  <span class="kw">install.packages</span>(<span class="st">&#39;pacman&#39;</span>)</a>
<a class="sourceLine" id="cb1-4" title="4">}</a></code></pre></div>
<pre><code>## Loading required package: pacman</code></pre>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb3-1" title="1"><span class="co"># load packages needed for this exercise</span></a>
<a class="sourceLine" id="cb3-2" title="2">pacman<span class="op">::</span><span class="kw">p_load</span>(tidyverse, <span class="co"># for data manipulation</span></a>
<a class="sourceLine" id="cb3-3" title="3">                             psych, <span class="co"># for `describe()` function</span></a>
<a class="sourceLine" id="cb3-4" title="4">                             ggpubr, <span class="co"># for graphing</span></a>
<a class="sourceLine" id="cb3-5" title="5">                             rlang, <span class="co"># for tidy evaluation</span></a>
<a class="sourceLine" id="cb3-6" title="6">                             ggfortify)</a></code></pre></div>
</div>
<div id="data" class="section level2">
<h2><span class="header-section-number">1.2</span> Data</h2>
<p>This is equivalent to the data step in SAS. Here, the data is imported from a file <code>ex1.csv</code> using the function <code>read_csv</code>. This function will download the data file direclty from <a href="https://raw.githubusercontent.com/luckymehra/epidem-exercises/master/data/ex1.csv">here</a>.</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb4-1" title="1"><span class="co"># Import data</span></a>
<a class="sourceLine" id="cb4-2" title="2">a &lt;-<span class="st"> </span><span class="kw">read_csv</span>(<span class="st">&quot;data/ex1.csv&quot;</span>) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb4-3" title="3"><span class="st">    </span><span class="co"># create a new variable `DIFF`</span></a>
<a class="sourceLine" id="cb4-4" title="4"><span class="st">    </span><span class="kw">mutate</span>(<span class="dt">DIFF =</span> ESTIMATE <span class="op">-</span><span class="st"> </span>ACTUAL)</a></code></pre></div>
<pre><code>## Parsed with column specification:
## cols(
##   TEST = col_character(),
##   OBS = col_double(),
##   ESTIMATE = col_double(),
##   ACTUAL = col_double()
## )</code></pre>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb6-1" title="1"><span class="co"># print the data</span></a>
<a class="sourceLine" id="cb6-2" title="2">a</a></code></pre></div>
<pre><code>## # A tibble: 60 x 5
##    TEST       OBS ESTIMATE ACTUAL  DIFF
##    &lt;chr&gt;    &lt;dbl&gt;    &lt;dbl&gt;  &lt;dbl&gt; &lt;dbl&gt;
##  1 BASELINE     1        2      7    -5
##  2 BASELINE     2       25     39   -14
##  3 BASELINE     3       35     49   -14
##  4 BASELINE     4       20     34   -14
##  5 BASELINE     5        5      8    -3
##  6 BASELINE     6       50     57    -7
##  7 BASELINE     7        5     14    -9
##  8 BASELINE     8       50     57    -7
##  9 BASELINE     9       60     73   -13
## 10 BASELINE    10        2      9    -7
## # ... with 50 more rows</code></pre>
</div>
<div id="descriptive-statistics" class="section level2">
<h2><span class="header-section-number">1.3</span> Descriptive statistics</h2>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb8-1" title="1"><span class="co"># use the describe() function to get an idea about different variables</span></a>
<a class="sourceLine" id="cb8-2" title="2">sm_a &lt;-<span class="st"> </span>a <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb8-3" title="3"><span class="st">    </span><span class="kw">group_by</span>(TEST) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb8-4" title="4"><span class="st">    </span><span class="kw">summarise_at</span>(<span class="kw">vars</span>(DIFF),</a>
<a class="sourceLine" id="cb8-5" title="5">                             <span class="kw">list</span>(<span class="op">~</span><span class="kw">mean</span>(., <span class="dt">na.rm =</span> <span class="ot">TRUE</span>),</a>
<a class="sourceLine" id="cb8-6" title="6">                                     <span class="op">~</span><span class="kw">mode</span>(.),</a>
<a class="sourceLine" id="cb8-7" title="7">                                     <span class="op">~</span><span class="kw">median</span>(., <span class="dt">na.rm =</span> <span class="ot">TRUE</span>),</a>
<a class="sourceLine" id="cb8-8" title="8">                                     <span class="op">~</span><span class="kw">sd</span>(., <span class="dt">na.rm =</span> <span class="ot">TRUE</span>),</a>
<a class="sourceLine" id="cb8-9" title="9">                                     <span class="op">~</span><span class="kw">var</span>(., <span class="dt">na.rm =</span> <span class="ot">TRUE</span>),</a>
<a class="sourceLine" id="cb8-10" title="10">                                     <span class="op">~</span><span class="kw">IQR</span>(., <span class="dt">na.rm =</span> <span class="ot">TRUE</span>),</a>
<a class="sourceLine" id="cb8-11" title="11">                                     <span class="op">~</span><span class="kw">min</span>(., <span class="dt">na.rm =</span> <span class="ot">TRUE</span>),</a>
<a class="sourceLine" id="cb8-12" title="12">                                     <span class="op">~</span><span class="kw">max</span>(., <span class="dt">na.rm =</span> <span class="ot">TRUE</span>),</a>
<a class="sourceLine" id="cb8-13" title="13">                                     <span class="op">~</span><span class="kw">n</span>(),</a>
<a class="sourceLine" id="cb8-14" title="14">                                     <span class="op">~</span><span class="kw">skew</span>(.),</a>
<a class="sourceLine" id="cb8-15" title="15">                                     <span class="op">~</span><span class="kw">kurtosi</span>(.)</a>
<a class="sourceLine" id="cb8-16" title="16">                                     )) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb8-17" title="17"><span class="st">    </span><span class="kw">mutate</span>(<span class="dt">CV =</span> (sd<span class="op">/</span>mean)<span class="op">*</span><span class="dv">100</span>,</a>
<a class="sourceLine" id="cb8-18" title="18">                 <span class="dt">std.err =</span> sd<span class="op">/</span><span class="kw">sqrt</span>(n)) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb8-19" title="19"><span class="st">    </span><span class="kw">ungroup</span>()</a>
<a class="sourceLine" id="cb8-20" title="20"></a>
<a class="sourceLine" id="cb8-21" title="21">sm_a</a></code></pre></div>
<pre><code>## # A tibble: 3 x 14
##   TEST   mean mode  median    sd   var   IQR   min   max     n    skew
##   &lt;chr&gt; &lt;dbl&gt; &lt;chr&gt;  &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;int&gt;   &lt;dbl&gt;
## 1 BASE~ -9.75 nume~   -9.5  4.17  17.4  6.5    -17    -3    20 -0.0599
## 2 POST1 -2.95 nume~   -2    4.43  19.6  7      -14     3    20 -0.804 
## 3 POST2 -2.75 nume~   -2.5  8.82  77.8  9.75   -18    12    20  0.0162
## # ... with 3 more variables: kurtosi &lt;dbl&gt;, CV &lt;dbl&gt;, std.err &lt;dbl&gt;</code></pre>
</div>
<div id="create-histogram-boxplot-and-qqplot" class="section level2">
<h2><span class="header-section-number">1.4</span> Create histogram, boxplot, and qqplot</h2>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb10-1" title="1"><span class="co"># histograms</span></a>
<a class="sourceLine" id="cb10-2" title="2">create_hist &lt;-<span class="st"> </span><span class="cf">function</span>(test_id){</a>
<a class="sourceLine" id="cb10-3" title="3">a <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb10-4" title="4"><span class="st">    </span><span class="kw">filter</span>(TEST <span class="op">==</span><span class="st"> </span>{{test_id}}) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb10-5" title="5"><span class="st">    </span><span class="kw">gghistogram</span>(<span class="st">&quot;DIFF&quot;</span>, <span class="dt">bins =</span> <span class="dv">6</span>, <span class="dt">fill =</span> <span class="st">&quot;skyblue&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb10-6" title="6"><span class="st">        </span><span class="kw">coord_flip</span>()</a>
<a class="sourceLine" id="cb10-7" title="7">}</a>
<a class="sourceLine" id="cb10-8" title="8"></a>
<a class="sourceLine" id="cb10-9" title="9"><span class="kw">create_hist</span>(<span class="kw">unique</span>(a<span class="op">$</span>TEST)[<span class="dv">1</span>]) <span class="co"># BASELINE</span></a></code></pre></div>
<p><img src="01-ex1_files/figure-html/plots-1.png" width="672" /></p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb11-1" title="1"><span class="kw">create_hist</span>(<span class="kw">unique</span>(a<span class="op">$</span>TEST)[<span class="dv">2</span>]) <span class="co"># POST1</span></a></code></pre></div>
<p><img src="01-ex1_files/figure-html/plots-2.png" width="672" /></p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb12-1" title="1"><span class="kw">create_hist</span>(<span class="kw">unique</span>(a<span class="op">$</span>TEST)[<span class="dv">3</span>]) <span class="co"># POST2</span></a></code></pre></div>
<p><img src="01-ex1_files/figure-html/plots-3.png" width="672" /></p>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb13-1" title="1"><span class="co"># boxplots</span></a>
<a class="sourceLine" id="cb13-2" title="2">create_box &lt;-<span class="st"> </span><span class="cf">function</span>(test_id){</a>
<a class="sourceLine" id="cb13-3" title="3">    a <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb13-4" title="4"><span class="st">        </span><span class="kw">filter</span>(TEST <span class="op">==</span><span class="st"> </span>{{test_id}}) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb13-5" title="5"><span class="st">        </span><span class="kw">ggboxplot</span>(<span class="dt">y =</span> <span class="st">&quot;DIFF&quot;</span>, <span class="dt">fill =</span>  <span class="st">&quot;skyblue&quot;</span>,</a>
<a class="sourceLine" id="cb13-6" title="6">                            <span class="dt">main =</span> {{test_id}})</a>
<a class="sourceLine" id="cb13-7" title="7">}</a>
<a class="sourceLine" id="cb13-8" title="8"></a>
<a class="sourceLine" id="cb13-9" title="9"><span class="kw">create_box</span>(<span class="kw">unique</span>(a<span class="op">$</span>TEST)[<span class="dv">1</span>]) <span class="co"># BASELINE</span></a></code></pre></div>
<p><img src="01-ex1_files/figure-html/plots-4.png" width="672" /></p>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb14-1" title="1"><span class="kw">create_box</span>(<span class="kw">unique</span>(a<span class="op">$</span>TEST)[<span class="dv">2</span>]) <span class="co"># POST1</span></a></code></pre></div>
<p><img src="01-ex1_files/figure-html/plots-5.png" width="672" /></p>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb15-1" title="1"><span class="kw">create_box</span>(<span class="kw">unique</span>(a<span class="op">$</span>TEST)[<span class="dv">3</span>]) <span class="co"># POST2</span></a></code></pre></div>
<p><img src="01-ex1_files/figure-html/plots-6.png" width="672" /></p>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb16-1" title="1"><span class="co"># distribution of DIFF by </span><span class="al">TEST</span></a>
<a class="sourceLine" id="cb16-2" title="2"><span class="kw">ggboxplot</span>(<span class="dt">data =</span> a,</a>
<a class="sourceLine" id="cb16-3" title="3">                    <span class="dt">x =</span> <span class="st">&quot;TEST&quot;</span>, <span class="dt">y =</span> <span class="st">&quot;DIFF&quot;</span>)</a></code></pre></div>
<p><img src="01-ex1_files/figure-html/plots-7.png" width="672" /></p>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb17-1" title="1"><span class="co"># qqplots</span></a>
<a class="sourceLine" id="cb17-2" title="2">create_qq &lt;-<span class="st"> </span><span class="cf">function</span>(test_id){</a>
<a class="sourceLine" id="cb17-3" title="3">a <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb17-4" title="4"><span class="st">    </span><span class="kw">filter</span>(TEST <span class="op">==</span><span class="st"> </span>{{test_id}}) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb17-5" title="5"><span class="st">    </span><span class="kw">ggqqplot</span>(<span class="st">&quot;DIFF&quot;</span>,</a>
<a class="sourceLine" id="cb17-6" title="6">                     <span class="dt">main =</span> {{test_id}}) </a>
<a class="sourceLine" id="cb17-7" title="7">}</a>
<a class="sourceLine" id="cb17-8" title="8"></a>
<a class="sourceLine" id="cb17-9" title="9"><span class="kw">create_qq</span>(<span class="kw">unique</span>(a<span class="op">$</span>TEST)[<span class="dv">1</span>]) <span class="co"># BASELINE</span></a></code></pre></div>
<p><img src="01-ex1_files/figure-html/plots-8.png" width="672" /></p>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb18-1" title="1"><span class="kw">create_qq</span>(<span class="kw">unique</span>(a<span class="op">$</span>TEST)[<span class="dv">2</span>]) <span class="co"># POST1</span></a></code></pre></div>
<p><img src="01-ex1_files/figure-html/plots-9.png" width="672" /></p>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb19-1" title="1"><span class="kw">create_qq</span>(<span class="kw">unique</span>(a<span class="op">$</span>TEST)[<span class="dv">3</span>]) <span class="co"># POST2</span></a></code></pre></div>
<p><img src="01-ex1_files/figure-html/plots-10.png" width="672" /></p>
</div>
<div id="normality-test" class="section level2">
<h2><span class="header-section-number">1.5</span> Normality test</h2>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb20-1" title="1">st &lt;-<span class="st"> </span><span class="kw">shapiro.test</span>(a<span class="op">$</span>DIFF)</a>
<a class="sourceLine" id="cb20-2" title="2"><span class="kw">data.frame</span>(st<span class="op">$</span>method, st<span class="op">$</span>statistic, st<span class="op">$</span>p.value)</a></code></pre></div>
<pre><code>##                     st.method st.statistic st.p.value
## W Shapiro-Wilk normality test    0.9783355  0.3622644</code></pre>
<div class="sourceCode" id="cb22"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb22-1" title="1">do_shp_test &lt;-<span class="st"> </span><span class="cf">function</span>(df){</a>
<a class="sourceLine" id="cb22-2" title="2">    st &lt;-<span class="st"> </span><span class="kw">shapiro.test</span>(df<span class="op">$</span>DIFF)</a>
<a class="sourceLine" id="cb22-3" title="3">    <span class="kw">data.frame</span>(st<span class="op">$</span>method, st<span class="op">$</span>statistic, st<span class="op">$</span>p.value)</a>
<a class="sourceLine" id="cb22-4" title="4">}</a>
<a class="sourceLine" id="cb22-5" title="5"></a>
<a class="sourceLine" id="cb22-6" title="6">a <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb22-7" title="7"><span class="st">    </span><span class="kw">group_by</span>(TEST) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb22-8" title="8"><span class="st">    </span><span class="kw">do</span>(<span class="kw">do_shp_test</span>(.)) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb22-9" title="9"><span class="st">    </span><span class="kw">ungroup</span>()</a></code></pre></div>
<pre><code>## # A tibble: 3 x 4
##   TEST     st.method                   st.statistic st.p.value
##   &lt;chr&gt;    &lt;fct&gt;                              &lt;dbl&gt;      &lt;dbl&gt;
## 1 BASELINE Shapiro-Wilk normality test        0.958     0.511 
## 2 POST1    Shapiro-Wilk normality test        0.919     0.0958
## 3 POST2    Shapiro-Wilk normality test        0.965     0.638</code></pre>
</div>
<div id="linear-regression" class="section level2">
<h2><span class="header-section-number">1.6</span> Linear regression</h2>
<div class="sourceCode" id="cb24"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb24-1" title="1"><span class="co"># fit linear regression by </span><span class="al">TEST</span></a>
<a class="sourceLine" id="cb24-2" title="2"><span class="co"># Response: ESTIMATE</span></a>
<a class="sourceLine" id="cb24-3" title="3">est_lm &lt;-<span class="st"> </span><span class="cf">function</span>(df){</a>
<a class="sourceLine" id="cb24-4" title="4">    model &lt;-<span class="st"> </span><span class="kw">lm</span>(ESTIMATE <span class="op">~</span><span class="st"> </span>ACTUAL, <span class="dt">data =</span> df)</a>
<a class="sourceLine" id="cb24-5" title="5">    </a>
<a class="sourceLine" id="cb24-6" title="6">    <span class="co"># fit plot</span></a>
<a class="sourceLine" id="cb24-7" title="7">    fit_plot &lt;-<span class="st"> </span><span class="kw">ggplot</span>(<span class="dt">data =</span> df, <span class="kw">aes</span>(<span class="dt">x =</span> ACTUAL, <span class="dt">y =</span> ESTIMATE)) <span class="op">+</span></a>
<a class="sourceLine" id="cb24-8" title="8"><span class="st">        </span><span class="kw">geom_point</span>()<span class="op">+</span></a>
<a class="sourceLine" id="cb24-9" title="9"><span class="st">        </span><span class="kw">stat_smooth</span>(<span class="dt">method =</span> <span class="st">&quot;lm&quot;</span>, <span class="dt">col =</span> <span class="st">&quot;blue&quot;</span>)</a>
<a class="sourceLine" id="cb24-10" title="10">    </a>
<a class="sourceLine" id="cb24-11" title="11">    <span class="kw">return</span>(<span class="kw">list</span>(<span class="kw">summary</span>(model), <span class="kw">autoplot</span>(model), fit_plot))</a>
<a class="sourceLine" id="cb24-12" title="12">}</a>
<a class="sourceLine" id="cb24-13" title="13"></a>
<a class="sourceLine" id="cb24-14" title="14"><span class="kw">by</span>(a, a<span class="op">$</span>TEST, est_lm)</a></code></pre></div>
<pre><code>## a$TEST: BASELINE
## [[1]]
## 
## Call:
## lm(formula = ESTIMATE ~ ACTUAL, data = df)
## 
## Residuals:
##     Min      1Q  Median      3Q     Max 
## -7.3419 -3.0730  0.3805  3.2750  6.3549 
## 
## Coefficients:
##             Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)  -9.1837     1.8107  -5.072 7.95e-05 ***
## ACTUAL        0.9852     0.0403  24.448 2.93e-15 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 4.264 on 18 degrees of freedom
## Multiple R-squared:  0.9708, Adjusted R-squared:  0.9691 
## F-statistic: 597.7 on 1 and 18 DF,  p-value: 2.933e-15
## 
## 
## [[2]]</code></pre>
<p><img src="01-ex1_files/figure-html/lin-reg-1.png" width="672" /></p>
<pre><code>## 
## [[3]]</code></pre>
<p><img src="01-ex1_files/figure-html/lin-reg-2.png" width="672" /></p>
<pre><code>## 
## -------------------------------------------------------- 
## a$TEST: POST1
## [[1]]
## 
## Call:
## lm(formula = ESTIMATE ~ ACTUAL, data = df)
## 
## Residuals:
##      Min       1Q   Median       3Q      Max 
## -11.0323  -2.7663   0.6561   3.5244   6.3667 
## 
## Coefficients:
##             Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)  -2.1033     1.9186  -1.096    0.287    
## ACTUAL        0.9778     0.0427  22.901 9.18e-15 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 4.518 on 18 degrees of freedom
## Multiple R-squared:  0.9668, Adjusted R-squared:  0.965 
## F-statistic: 524.5 on 1 and 18 DF,  p-value: 9.183e-15
## 
## 
## [[2]]</code></pre>
<p><img src="01-ex1_files/figure-html/lin-reg-3.png" width="672" /></p>
<pre><code>## 
## [[3]]</code></pre>
<p><img src="01-ex1_files/figure-html/lin-reg-4.png" width="672" /></p>
<pre><code>## 
## -------------------------------------------------------- 
## a$TEST: POST2
## [[1]]
## 
## Call:
## lm(formula = ESTIMATE ~ ACTUAL, data = df)
## 
## Residuals:
##      Min       1Q   Median       3Q      Max 
## -15.9575  -4.2873   0.8961   6.2328   9.6890 
## 
## Coefficients:
##              Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept) -11.40269    3.67614  -3.102  0.00615 ** 
## ACTUAL        1.21768    0.08178  14.889 1.46e-11 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 7.675 on 18 degrees of freedom
## Multiple R-squared:  0.9249, Adjusted R-squared:  0.9207 
## F-statistic: 221.7 on 1 and 18 DF,  p-value: 1.46e-11
## 
## 
## [[2]]</code></pre>
<p><img src="01-ex1_files/figure-html/lin-reg-5.png" width="672" /></p>
<pre><code>## 
## [[3]]</code></pre>
<p><img src="01-ex1_files/figure-html/lin-reg-6.png" width="672" /></p>
<div class="sourceCode" id="cb31"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb31-1" title="1"><span class="co"># Response: DIFF</span></a>
<a class="sourceLine" id="cb31-2" title="2">diff_lm &lt;-<span class="st"> </span><span class="cf">function</span>(df){</a>
<a class="sourceLine" id="cb31-3" title="3">    model &lt;-<span class="st"> </span><span class="kw">lm</span>(DIFF <span class="op">~</span><span class="st"> </span>ACTUAL, <span class="dt">data =</span> df)</a>
<a class="sourceLine" id="cb31-4" title="4">    </a>
<a class="sourceLine" id="cb31-5" title="5">    <span class="co"># fit plot </span></a>
<a class="sourceLine" id="cb31-6" title="6">    fit_plot &lt;-<span class="st"> </span><span class="kw">ggplot</span>(<span class="dt">data =</span> df, <span class="kw">aes</span>(<span class="dt">x =</span> ACTUAL, <span class="dt">y =</span> DIFF)) <span class="op">+</span></a>
<a class="sourceLine" id="cb31-7" title="7"><span class="st">        </span><span class="kw">geom_point</span>()<span class="op">+</span></a>
<a class="sourceLine" id="cb31-8" title="8"><span class="st">        </span><span class="kw">stat_smooth</span>(<span class="dt">method =</span> <span class="st">&quot;lm&quot;</span>, <span class="dt">col =</span> <span class="st">&quot;blue&quot;</span>)</a>
<a class="sourceLine" id="cb31-9" title="9">        </a>
<a class="sourceLine" id="cb31-10" title="10">    <span class="kw">return</span>(<span class="kw">list</span>(<span class="kw">summary</span>(model), <span class="kw">autoplot</span>(model)))</a>
<a class="sourceLine" id="cb31-11" title="11">}</a>
<a class="sourceLine" id="cb31-12" title="12"></a>
<a class="sourceLine" id="cb31-13" title="13"><span class="kw">by</span>(a, a<span class="op">$</span>TEST, diff_lm)</a></code></pre></div>
<pre><code>## a$TEST: BASELINE
## [[1]]
## 
## Call:
## lm(formula = DIFF ~ ACTUAL, data = df)
## 
## Residuals:
##     Min      1Q  Median      3Q     Max 
## -7.3419 -3.0730  0.3805  3.2750  6.3549 
## 
## Coefficients:
##             Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept) -9.18368    1.81073  -5.072 7.95e-05 ***
## ACTUAL      -0.01483    0.04030  -0.368    0.717    
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 4.264 on 18 degrees of freedom
## Multiple R-squared:  0.007463,   Adjusted R-squared:  -0.04768 
## F-statistic: 0.1353 on 1 and 18 DF,  p-value: 0.7172
## 
## 
## [[2]]</code></pre>
<p><img src="01-ex1_files/figure-html/lin-reg-7.png" width="672" /></p>
<pre><code>## 
## -------------------------------------------------------- 
## a$TEST: POST1
## [[1]]
## 
## Call:
## lm(formula = DIFF ~ ACTUAL, data = df)
## 
## Residuals:
##      Min       1Q   Median       3Q      Max 
## -11.0323  -2.7663   0.6561   3.5244   6.3667 
## 
## Coefficients:
##             Estimate Std. Error t value Pr(&gt;|t|)
## (Intercept) -2.10325    1.91861  -1.096    0.287
## ACTUAL      -0.02217    0.04270  -0.519    0.610
## 
## Residual standard error: 4.518 on 18 degrees of freedom
## Multiple R-squared:  0.01475,    Adjusted R-squared:  -0.03998 
## F-statistic: 0.2695 on 1 and 18 DF,  p-value: 0.61
## 
## 
## [[2]]</code></pre>
<p><img src="01-ex1_files/figure-html/lin-reg-8.png" width="672" /></p>
<pre><code>## 
## -------------------------------------------------------- 
## a$TEST: POST2
## [[1]]
## 
## Call:
## lm(formula = DIFF ~ ACTUAL, data = df)
## 
## Residuals:
##      Min       1Q   Median       3Q      Max 
## -15.9575  -4.2873   0.8961   6.2328   9.6890 
## 
## Coefficients:
##              Estimate Std. Error t value Pr(&gt;|t|)   
## (Intercept) -11.40269    3.67614  -3.102  0.00615 **
## ACTUAL        0.21768    0.08178   2.662  0.01589 * 
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 7.675 on 18 degrees of freedom
## Multiple R-squared:  0.2824, Adjusted R-squared:  0.2426 
## F-statistic: 7.084 on 1 and 18 DF,  p-value: 0.01589
## 
## 
## [[2]]</code></pre>
<p><img src="01-ex1_files/figure-html/lin-reg-9.png" width="672" /></p>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="index.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="ex4.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"google": false,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "google", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/rstudio/bookdown-demo/edit/master/01-ex1.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"download": ["_epidem_exercises.pdf", "_epidem_exercises.epub"],
"toc": {
"collapse": "subsection"
}
});
});
</script>

</body>

</html>
